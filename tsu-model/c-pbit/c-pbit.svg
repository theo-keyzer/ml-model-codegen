<svg width="700" height="500" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="350" y="30" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Differential Pair P-bit Circuit</text>
  
  <!-- Main Circuit Box -->
  <rect x="50" y="50" width="600" height="400" fill="none" stroke="#333" stroke-width="2"/>
  
  <!-- === LEFT SIDE: INPUT STAGE === -->
  <text x="150" y="80" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Input Stage</text>
  
  <!-- Differential Input Voltages -->
  <circle cx="100" cy="120" r="8" fill="#4CAF50"/>
  <text x="100" y="140" text-anchor="middle" font-family="Arial" font-size="10">V_IN+</text>
  <line x1="100" y1="128" x2="100" y2="160" stroke="#4CAF50" stroke-width="2"/>
  
  <circle cx="200" cy="120" r="8" fill="#4CAF50"/>
  <text x="200" y="140" text-anchor="middle" font-family="Arial" font-size="10">V_IN-</text>
  <line x1="200" y1="128" x2="200" y2="160" stroke="#4CAF50" stroke-width="2"/>
  
  <!-- === CENTER: DIFFERENTIAL PAIR CORE === -->
  <text x="350" y="80" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Differential Pair Core</text>
  
  <!-- Transistor M1 -->
  <polygon points="130,160 130,200 150,200 150,160" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <line x1="130" y1="180" x2="120" y2="180" stroke="#2196F3" stroke-width="2"/> <!-- Source -->
  <line x1="150" y1="180" x2="160" y2="180" stroke="#2196F3" stroke-width="2"/> <!-- Drain -->
  <line x1="140" y1="160" x2="140" y2="150" stroke="#2196F3" stroke-width="2"/> <!-- Gate -->
  <text x="140" y="195" text-anchor="middle" font-family="Arial" font-size="8">M1</text>
  
  <!-- Transistor M2 -->
  <polygon points="230,160 230,200 250,200 250,160" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <line x1="230" y1="180" x2="220" y2="180" stroke="#2196F3" stroke-width="2"/> <!-- Source -->
  <line x1="250" y1="180" x2="260" y2="180" stroke="#2196F3" stroke-width="2"/> <!-- Drain -->
  <line x1="240" y1="160" x2="240" y2="150" stroke="#2196F3" stroke-width="2"/> <!-- Gate -->
  <text x="240" y="195" text-anchor="middle" font-family="Arial" font-size="8">M2</text>
  
  <!-- Common Source Node -->
  <circle cx="190" cy="220" r="6" fill="#FF9800"/>
  <line x1="140" y1="220" x2="190" y2="220" stroke="#333" stroke-width="2"/>
  <line x1="190" y1="220" x2="240" y2="220" stroke="#333" stroke-width="2"/>
  
  <!-- Tail Current Source -->
  <rect x="180" y="220" width="20" height="40" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
  <line x1="190" y1="260" x2="190" y2="280" stroke="#FF9800" stroke-width="2"/>
  <text x="190" y="245" text-anchor="middle" font-family="Arial" font-size="8">I_TAIL</text>
  
  <!-- Stochastic Noise Source -->
  <circle cx="190" cy="300" r="12" fill="#9C27B0"/>
  <path d="M 185,295 Q 190,285, 195,295 Q 200,305, 185,295 Q 190,310, 195,305" 
        fill="none" stroke="white" stroke-width="1.5"/>
  <text x="190" y="320" text-anchor="middle" font-family="Arial" font-size="8">Noise</text>
  <text x="190" y="328" text-anchor="middle" font-family="Arial" font-size="8">Source</text>
  <line x1="190" y1="288" x2="190" y2="312" stroke="#9C27B0" stroke-width="2" stroke-dasharray="3,3"/>
  
  <!-- === RIGHT SIDE: OUTPUT STAGE === -->
  <text x="500" y="80" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Output Stage</text>
  
  <!-- Load Resistors -->
  <!-- R1 -->
  <line x1="160" y1="180" x2="160" y2="120" stroke="#F44336" stroke-width="3"/>
  <line x1="155" y1="130" x2="165" y2="130" stroke="#F44336" stroke-width="2"/>
  <line x1="158" y1="140" x2="162" y2="140" stroke="#F44336" stroke-width="2"/>
  <text x="170" y="150" text-anchor="start" font-family="Arial" font-size="8">R_L1</text>
  
  <!-- R2 -->
  <line x1="260" y1="180" x2="260" y2="120" stroke="#F44336" stroke-width="3"/>
  <line x1="255" y1="130" x2="265" y2="130" stroke="#F44336" stroke-width="2"/>
  <line x1="258" y1="140" x2="262" y2="140" stroke="#F44336" stroke-width="2"/>
  <text x="270" y="150" text-anchor="start" font-family="Arial" font-size="8">R_L2</text>
  
  <!-- Output Nodes -->
  <circle cx="160" cy="120" r="4" fill="#333"/>
  <circle cx="260" cy="120" r="4" fill="#333"/>
  
  <!-- Output Voltages -->
  <text x="160" y="100" text-anchor="middle" font-family="Arial" font-size="9">V_OUT1</text>
  <text x="260" y="100" text-anchor="middle" font-family="Arial" font-size="9">V_OUT2</text>
  
  <!-- Current Mirrors for Load -->
  <polygon points="150,110 150,130 170,130 170,110" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1"/>
  <text x="160" y="122" text-anchor="middle" font-family="Arial" font-size="6">Active</text>
  <text x="160" y="127" text-anchor="middle" font-family="Arial" font-size="6">Load</text>
  
  <polygon points="250,110 250,130 270,130 270,110" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1"/>
  <text x="260" y="122" text-anchor="middle" font-family="Arial" font-size="6">Active</text>
  <text x="260" y="127" text-anchor="middle" font-family="Arial" font-size="6">Load</text>
  
  <!-- === PROBABILITY COMPUTATION === -->
  <text x="500" y="180" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Probability Computation</text>
  
  <!-- Current-to-Voltage Converters -->
  <rect x="430" y="200" width="40" height="30" fill="#E3F2FD" stroke="#2196F3" stroke-width="1"/>
  <text x="450" y="215" text-anchor="middle" font-family="Arial" font-size="7">I/V</text>
  <text x="450" y="222" text-anchor="middle" font-family="Arial" font-size="7">Conv1</text>
  
  <rect x="480" y="200" width="40" height="30" fill="#E3F2FD" stroke="#2196F3" stroke-width="1"/>
  <text x="500" y="215" text-anchor="middle" font-family="Arial" font-size="7">I/V</text>
  <text x="500" y="222" text-anchor="middle" font-family="Arial" font-size="7">Conv2</text>
  
  <!-- Analog Divider -->
  <rect x="460" y="250" width="60" height="30" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
  <text x="490" y="265" text-anchor="middle" font-family="Arial" font-size="8">Divider</text>
  <text x="490" y="272" text-anchor="middle" font-family="Arial" font-size="7">I1/(I1+I2)</text>
  
  <!-- Output Probability -->
  <line x1="490" y1="280" x2="490" y2="300" stroke="#9C27B0" stroke-width="2"/>
  <circle cx="490" cy="310" r="15" fill="#9C27B0"/>
  <text x="490" y="313" text-anchor="middle" font-family="Arial" font-size="8" fill="white">P(1)</text>
  
  <!-- Final Output -->
  <line x1="490" y1="325" x2="490" y2="350" stroke="#333" stroke-width="2"/>
  <text x="490" y="370" text-anchor="middle" font-family="Arial" font-size="10">Stochastic Output</text>
  <text x="490" y="382" text-anchor="middle" font-family="Arial" font-size="9">P(1) = I1 / (I1 + I2)</text>
  
  <!-- === CONNECTIONS === -->
  
  <!-- Input to Gates -->
  <line x1="100" y1="160" x2="140" y2="150" stroke="#4CAF50" stroke-width="2"/>
  <line x1="200" y1="160" x2="240" y2="150" stroke="#4CAF50" stroke-width="2"/>
  
  <!-- Outputs to Probability Block -->
  <line x1="160" y1="120" x2="430" y2="215" stroke="#F44336" stroke-width="1" stroke-dasharray="5,5"/>
  <line x1="260" y1="120" x2="480" y2="215" stroke="#F44336" stroke-width="1" stroke-dasharray="5,5"/>
  
  <!-- I/V to Divider -->
  <line x1="470" y1="230" x2="460" y2="250" stroke="#2196F3" stroke-width="1"/>
  <line x1="490" y1="230" x2="490" y2="250" stroke="#2196F3" stroke-width="1"/>
  
  <!-- Power Supplies -->
  <line x1="120" y1="100" x2="120" y2="80" stroke="#666" stroke-width="2"/>
  <text x="110" y="70" text-anchor="middle" font-family="Arial" font-size="8">VDD</text>
  
  <line x1="280" y1="100" x2="280" y2="80" stroke="#666" stroke-width="2"/>
  <text x="270" y="70" text-anchor="middle" font-family="Arial" font-size="8">VDD</text>
  
  <!-- Ground -->
  <line x1="190" y1="340" x2="190" y2="360" stroke="#333" stroke-width="2"/>
  <line x1="185" y1="360" x2="195" y2="360" stroke="#333" stroke-width="2"/>
  <line x1="180" y1="365" x2="200" y2="365" stroke="#333" stroke-width="2"/>
  <line x1="175" y1="370" x2="205" y2="370" stroke="#333" stroke-width="2"/>
  <text x="190" y="385" text-anchor="middle" font-family="Arial" font-size="8">GND</text>
  
  <!-- === ANNOTATIONS === -->
  
  <!-- Operation Principle -->
  <text x="350" y="420" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">
    Differential Pair P-bit Operation:
  </text>
  <text x="350" y="435" text-anchor="middle" font-family="Arial" font-size="9">
    I1 = I_TAIL / (1 + exp(-(V_IN+ - V_IN- + noise)/V_T))
  </text>
  <text x="350" y="450" text-anchor="middle" font-family="Arial" font-size="9">
    P(1) = I1 / (I1 + I2) = sigmoid(V_IN+ - V_IN- + stochastic_noise)
  </text>
  
  <!-- Advantages -->
  <text x="100" y="320" text-anchor="middle" font-family="Arial" font-size="8" fill="#4CAF50">
    Advantages:
  </text>
  <text x="100" y="335" text-anchor="middle" font-family="Arial" font-size="7" fill="#4CAF50">
    • Noise Robust
  </text>
  <text x="100" y="345" text-anchor="middle" font-family="Arial" font-size="7" fill="#4CAF50">
    • Symmetric
  </text>
  <text x="100" y="355" text-anchor="middle" font-family="Arial" font-size="7" fill="#4CAF50">
    • Easy Cascading
  </text>
</svg>
